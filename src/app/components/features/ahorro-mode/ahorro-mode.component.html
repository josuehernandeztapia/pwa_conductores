<div class="ahorro-container p-6 max-w-4xl mx-auto">
  <div class="bg-white rounded-lg shadow-lg p-6">
    <h2 class="text-2xl font-bold text-gray-800 mb-6">💰 Modo Ahorro</h2>
    
    <!-- Selector de mercado y tipo de cliente -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="form-group">
        <label class="block text-sm font-medium text-gray-700 mb-2">Mercado:</label>
        <select 
          [(ngModel)]="selectedMarket" 
          (ngModelChange)="updateScenario()"
          class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
        >
          <option value="edomex">Estado de México</option>
          <option value="aguascalientes">Aguascalientes</option>
        </select>
      </div>
      
      <div class="form-group">
        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Cliente:</label>
        <select 
          [(ngModel)]="selectedClientType" 
          (ngModelChange)="updateScenario()"
          class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
        >
          <option value="colectivo">Colectivo</option>
          <option value="individual">Individual</option>
        </select>
      </div>
    </div>

    <!-- Panel de configuración según el escenario -->
    <div class="bg-gray-50 rounded-lg p-4 mb-6">
      <h3 class="text-lg font-semibold mb-4">Configuración - {{ scenario }}</h3>
      
      <!-- Tanda EdoMex -->
      <div *ngIf="scenario === 'tanda_edomex'" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Miembros: {{ tandaMembers }}</label>
          <input 
            type="range" 
            min="3" 
            max="15" 
            [(ngModel)]="tandaMembers" 
            (ngModelChange)="runSimulation()"
            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
          >
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Contribución Mensual:</label>
          <input 
            type="number" 
            [(ngModel)]="tandaContribution" 
            (ngModelChange)="runSimulation()"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
          >
        </div>
      </div>

      <!-- Planificador EdoMex -->
      <div *ngIf="scenario === 'planificador_edomex'" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Contribución Voluntaria Mensual:</label>
          <input 
            type="number" 
            [(ngModel)]="voluntaryContribution" 
            (ngModelChange)="runSimulation()"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
          >
        </div>
      </div>

      <!-- Proyector AGS -->
      <div *ngIf="scenario === 'proyector_ags'" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Enganche Inicial:</label>
          <input 
            type="number" 
            [(ngModel)]="initialDownPayment" 
            (ngModelChange)="runSimulation()"
            class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
          >
        </div>
      </div>
    </div>

    <!-- Resultados -->
    <div class="results-panel">
      <!-- Resultados Tanda -->
      <div *ngIf="scenario === 'tanda_edomex' && tandaResult">
        <h3 class="text-lg font-semibold mb-4">Resultados de la Simulación</h3>
        <div class="bg-blue-50 rounded-lg p-4 mb-4">
          <p class="text-sm text-blue-800"><strong>Duración:</strong> {{ tandaResult.months.length }} meses</p>
          <p class="text-sm text-blue-800"><strong>Total de Adjudicaciones:</strong> {{ getObjectKeys(tandaResult.finalAwards).length }}</p>
        </div>
        
        <div class="overflow-x-auto">
          <table class="min-w-full bg-white border border-gray-300 rounded-lg">
            <thead class="bg-gray-100">
              <tr>
                <th class="py-2 px-4 text-left">Mes</th>
                <th class="py-2 px-4 text-left">Ingresos</th>
                <th class="py-2 px-4 text-left">Deuda</th>
                <th class="py-2 px-4 text-left">Superávit</th>
                <th class="py-2 px-4 text-left">Ahorros</th>
                <th class="py-2 px-4 text-left">Adjudicaciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let month of tandaResult.months.slice(0, 12)" class="border-t">
                <td class="py-2 px-4">{{ month.t }}</td>
                <td class="py-2 px-4">{{ month.inflow | currency }}</td>
                <td class="py-2 px-4">{{ month.debtDue | currency }}</td>
                <td class="py-2 px-4" [class.text-red-600]="month.surplus < 0" [class.text-green-600]="month.surplus >= 0">
                  {{ month.surplus | currency }}
                </td>
                <td class="py-2 px-4">{{ month.savings | currency }}</td>
                <td class="py-2 px-4">{{ month.awardsInMonth.length }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Resultados Planificador -->
      <div *ngIf="scenario === 'planificador_edomex'">
        <h3 class="text-lg font-semibold mb-4">Plan de Ahorro Individual</h3>
        <div class="bg-green-50 rounded-lg p-4">
          <p class="text-green-800"><strong>Tiempo para alcanzar el enganche:</strong> {{ timeToGoal }} meses</p>
          <p class="text-green-800"><strong>Meta de enganche:</strong> {{ (837000 * 0.15) | currency }}</p>
        </div>
      </div>

      <!-- Resultados Proyector AGS -->
      <div *ngIf="scenario === 'proyector_ags'">
        <h3 class="text-lg font-semibold mb-4">Proyección AGS</h3>
        <div class="bg-purple-50 rounded-lg p-4">
          <p class="text-purple-800">Funcionalidad en desarrollo...</p>
        </div>
      </div>
    </div>
  </div>
</div>