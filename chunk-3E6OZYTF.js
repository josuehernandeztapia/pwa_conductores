import{b as Y,c as X,d as U,e as H,f as Q,g as Z,h as $,i as ee,l as te}from"./chunk-CTNMEYGD.js";import{Ba as L,Fa as I,Nb as z,Ob as q,Sb as J,Tb as K,X as g,Y as _,Ya as h,Za as i,_a as t,db as T,fb as x,hb as c,mb as j,ob as o,pb as v,qb as f,sb as M,ta as l,tb as b,ub as C,wb as S,xb as w}from"./chunk-IDEEAVYW.js";import"./chunk-EQDQRRRY.js";function ae(a,m,e){let r=m/12;if(r===0)return a/e;let n=Math.pow(1+r,e);return a*(r*n)/(n-1)}function ne(a){let{group:m,horizonMonths:e,events:r=[]}=a,{productPackage:n}=m,d=JSON.parse(JSON.stringify(m.members)),y=d.sort((p,O)=>p.prio-O.prio).map(p=>p.id),E=0,R=[],B=[],N={};for(let p=1;p<=e;p++){let O=r.filter(s=>s.month===p&&(s.type==="MEMBER_LEAVES"||s.type==="MEMBER_JOINS"));for(let s of O)if(s.type==="MEMBER_LEAVES")d=d.filter(u=>u.id!==s.memberId),y=y.filter(u=>u!==s.memberId);else if(s.type==="MEMBER_JOINS"){let u=s;d.push(u.newMember),y.push(u.newMember.id)}let V=0,oe=r.filter(s=>s.month===p&&(s.type==="EXTRA_CONTRIBUTION"||s.type==="MISSED_PAYMENT"));for(let s of oe)s.type==="EXTRA_CONTRIBUTION"&&(V+=s.amount),s.type==="MISSED_PAYMENT"&&(V-=s.amount);let W=d.reduce((s,u)=>s+u.baseContribution,0)+V,F=R.reduce((s,u)=>s+u.mds,0),A=W-F;A>=0&&(E+=A);let G=[],P=n.price*n.minDownPaymentPct;for(;E>=P&&y.length>0;){let s=y.shift();if(!s)break;E-=P;let u=n.price-P,re=ae(u,n.rateAnnual,n.term),k={memberId:s,month:p,unitPrice:n.price,dpPaid:P,principal:u,mds:re};R.push(k),G.push(k),N[s]=k}if(B.push({t:p,inflow:W,debtDue:F,surplus:A,savings:E,awardsInMonth:G,riskBadge:A<0?"debtDeficit":"ok"}),y.length===0&&d.length>0)break}return{months:B,finalAwards:N}}function le(a,m){if(a&1){let e=T();i(0,"div",16)(1,"div")(2,"label",5),o(3),t(),i(4,"input",17),C("ngModelChange",function(n){g(e);let d=c();return b(d.tandaMembers,n)||(d.tandaMembers=n),_(n)}),x("ngModelChange",function(){g(e);let n=c();return _(n.runSimulation())}),t()(),i(5,"div")(6,"label",5),o(7,"Contribuci\xF3n Mensual:"),t(),i(8,"input",18),C("ngModelChange",function(n){g(e);let d=c();return b(d.tandaContribution,n)||(d.tandaContribution=n),_(n)}),x("ngModelChange",function(){g(e);let n=c();return _(n.runSimulation())}),t()()()}if(a&2){let e=c();l(3),f("Miembros: ",e.tandaMembers),l(),M("ngModel",e.tandaMembers),l(4),M("ngModel",e.tandaContribution)}}function de(a,m){if(a&1){let e=T();i(0,"div",16)(1,"div")(2,"label",5),o(3,"Contribuci\xF3n Voluntaria Mensual:"),t(),i(4,"input",18),C("ngModelChange",function(n){g(e);let d=c();return b(d.voluntaryContribution,n)||(d.voluntaryContribution=n),_(n)}),x("ngModelChange",function(){g(e);let n=c();return _(n.runSimulation())}),t()()()}if(a&2){let e=c();l(4),M("ngModel",e.voluntaryContribution)}}function se(a,m){if(a&1){let e=T();i(0,"div",16)(1,"div")(2,"label",5),o(3,"Enganche Inicial:"),t(),i(4,"input",18),C("ngModelChange",function(n){g(e);let d=c();return b(d.initialDownPayment,n)||(d.initialDownPayment=n),_(n)}),x("ngModelChange",function(){g(e);let n=c();return _(n.runSimulation())}),t()()()}if(a&2){let e=c();l(4),M("ngModel",e.initialDownPayment)}}function me(a,m){if(a&1&&(i(0,"tr",26)(1,"td",27),o(2),t(),i(3,"td",27),o(4),S(5,"currency"),t(),i(6,"td",27),o(7),S(8,"currency"),t(),i(9,"td",27),o(10),S(11,"currency"),t(),i(12,"td",27),o(13),S(14,"currency"),t(),i(15,"td",27),o(16),t()()),a&2){let e=m.$implicit;l(2),v(e.t),l(2),v(w(5,10,e.inflow)),l(3),v(w(8,12,e.debtDue)),l(2),j("text-red-600",e.surplus<0)("text-green-600",e.surplus>=0),l(),f(" ",w(11,14,e.surplus)," "),l(3),v(w(14,16,e.savings)),l(3),v(e.awardsInMonth.length)}}function ce(a,m){if(a&1&&(i(0,"div")(1,"h3",12),o(2,"Resultados de la Simulaci\xF3n"),t(),i(3,"div",19)(4,"p",20)(5,"strong"),o(6,"Duraci\xF3n:"),t(),o(7),t(),i(8,"p",20)(9,"strong"),o(10,"Total de Adjudicaciones:"),t(),o(11),t()(),i(12,"div",21)(13,"table",22)(14,"thead",23)(15,"tr")(16,"th",24),o(17,"Mes"),t(),i(18,"th",24),o(19,"Ingresos"),t(),i(20,"th",24),o(21,"Deuda"),t(),i(22,"th",24),o(23,"Super\xE1vit"),t(),i(24,"th",24),o(25,"Ahorros"),t(),i(26,"th",24),o(27,"Adjudicaciones"),t()()(),i(28,"tbody"),I(29,me,17,18,"tr",25),t()()()()),a&2){let e=c();l(7),f(" ",e.tandaResult.months.length," meses"),l(4),f(" ",e.getObjectKeys(e.tandaResult.finalAwards).length),l(18),h("ngForOf",e.tandaResult.months.slice(0,12))}}function ue(a,m){if(a&1&&(i(0,"div")(1,"h3",12),o(2,"Plan de Ahorro Individual"),t(),i(3,"div",28)(4,"p",29)(5,"strong"),o(6,"Tiempo para alcanzar el enganche:"),t(),o(7),t(),i(8,"p",29)(9,"strong"),o(10,"Meta de enganche:"),t(),o(11),S(12,"currency"),t()()()),a&2){let e=c();l(7),f(" ",e.timeToGoal," meses"),l(4),f(" ",w(12,2,837e3*.15))}}function pe(a,m){a&1&&(i(0,"div")(1,"h3",12),o(2,"Proyecci\xF3n AGS"),t(),i(3,"div",30)(4,"p",31),o(5,"Funcionalidad en desarrollo..."),t()()())}var D={market:"edomex",name:"Paquete Productivo Completo",components:[],term:60,rateAnnual:.299,minDownPaymentPct:.15,price:837e3};var ie=class a{selectedMarket="edomex";selectedClientType="colectivo";scenario="tanda_edomex";tandaMembers=5;tandaContribution=5e3;voluntaryContribution=2e3;initialDownPayment=511800;tandaResult=null;timeToGoal=0;getObjectKeys(m){return Object.keys(m||{})}ngOnInit(){this.updateScenario()}updateScenario(){this.selectedMarket==="edomex"?this.scenario=this.selectedClientType==="colectivo"?"tanda_edomex":"planificador_edomex":this.scenario="proyector_ags",this.runSimulation()}runSimulation(){if(this.scenario==="tanda_edomex"){let m=Array.from({length:this.tandaMembers},(r,n)=>({id:`mem${n+1}`,name:`Miembro ${n+1}`,prio:n+1,status:"active",baseContribution:this.tandaContribution})),e={id:"tanda-sim",name:"Simulaci\xF3n Tanda",market:"edomex",productPackage:D,members:m};this.tandaResult=ne({group:e,horizonMonths:120})}else if(this.scenario==="planificador_edomex"){let m=D.price*D.minDownPaymentPct;this.timeToGoal=this.voluntaryContribution>0?Math.ceil(m/this.voluntaryContribution):0}}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=L({type:a,selectors:[["app-ahorro-mode"]],decls:31,vars:9,consts:[[1,"ahorro-container","p-6","max-w-4xl","mx-auto"],[1,"bg-white","rounded-lg","shadow-lg","p-6"],[1,"text-2xl","font-bold","text-gray-800","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"form-group"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"w-full","p-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["value","edomex"],["value","aguascalientes"],["value","colectivo"],["value","individual"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"text-lg","font-semibold","mb-4"],["class","grid grid-cols-1 md:grid-cols-2 gap-4",4,"ngIf"],[1,"results-panel"],[4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","range","min","3","max","15",1,"w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer",3,"ngModelChange","ngModel"],["type","number",1,"w-full","p-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"bg-blue-50","rounded-lg","p-4","mb-4"],[1,"text-sm","text-blue-800"],[1,"overflow-x-auto"],[1,"min-w-full","bg-white","border","border-gray-300","rounded-lg"],[1,"bg-gray-100"],[1,"py-2","px-4","text-left"],["class","border-t",4,"ngFor","ngForOf"],[1,"border-t"],[1,"py-2","px-4"],[1,"bg-green-50","rounded-lg","p-4"],[1,"text-green-800"],[1,"bg-purple-50","rounded-lg","p-4"],[1,"text-purple-800"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"\u{1F4B0} Modo Ahorro"),t(),i(4,"div",3)(5,"div",4)(6,"label",5),o(7,"Mercado:"),t(),i(8,"select",6),C("ngModelChange",function(d){return b(r.selectedMarket,d)||(r.selectedMarket=d),d}),x("ngModelChange",function(){return r.updateScenario()}),i(9,"option",7),o(10,"Estado de M\xE9xico"),t(),i(11,"option",8),o(12,"Aguascalientes"),t()()(),i(13,"div",4)(14,"label",5),o(15,"Tipo de Cliente:"),t(),i(16,"select",6),C("ngModelChange",function(d){return b(r.selectedClientType,d)||(r.selectedClientType=d),d}),x("ngModelChange",function(){return r.updateScenario()}),i(17,"option",9),o(18,"Colectivo"),t(),i(19,"option",10),o(20,"Individual"),t()()()(),i(21,"div",11)(22,"h3",12),o(23),t(),I(24,le,9,3,"div",13)(25,de,5,1,"div",13)(26,se,5,1,"div",13),t(),i(27,"div",14),I(28,ce,30,3,"div",15)(29,ue,13,4,"div",15)(30,pe,6,0,"div",15),t()()()),e&2&&(l(8),M("ngModel",r.selectedMarket),l(8),M("ngModel",r.selectedClientType),l(7),f("Configuraci\xF3n - ",r.scenario),l(),h("ngIf",r.scenario==="tanda_edomex"),l(),h("ngIf",r.scenario==="planificador_edomex"),l(),h("ngIf",r.scenario==="proyector_ags"),l(2),h("ngIf",r.scenario==="tanda_edomex"&&r.tandaResult),l(),h("ngIf",r.scenario==="planificador_edomex"),l(),h("ngIf",r.scenario==="proyector_ags"))},dependencies:[K,z,q,te,$,ee,Y,H,Q,Z,X,U,J],styles:[".ahorro-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8fafc}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}input[type=range][_ngcontent-%COMP%]{background:linear-gradient(to right,#3b82f6,#60a5fa)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{appearance:none;height:20px;width:20px;border-radius:50%;background:#3b82f6;cursor:pointer;border:2px solid #ffffff;box-shadow:0 2px 4px #0003}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{height:20px;width:20px;border-radius:50%;background:#3b82f6;cursor:pointer;border:2px solid #ffffff;box-shadow:0 2px 4px #0003}.results-panel[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};export{ie as AhorroModeComponent};
