import{a as z}from"./chunk-Y2D5TXOC.js";import"./chunk-FK6H3RFT.js";import{a as I}from"./chunk-KIPHH6M7.js";import"./chunk-BYXBJQAS.js";import{Ba as b,I as _,Sa as E,Ta as P,Tb as k,Wa as O,X as g,Xa as M,Y as p,ab as n,bb as i,cb as f,db as S,eb as y,f as u,ga as h,gb as C,hb as m,nb as D,ob as o,pb as c,qb as w,sa as x,ta as r,xa as v}from"./chunk-IDEEAVYW.js";import"./chunk-EQDQRRRY.js";var F=(a,t)=>t.id;function L(a,t){a&1&&(n(0,"div",4),f(1,"div",6),n(2,"p"),o(3,"Cargando datos del dashboard..."),i()())}function $(a,t){if(a&1){let e=S();n(0,"div",14),C("click",function(){let l=g(e).$implicit,s=m(2);return p(s.onClientSelect(l))}),f(1,"img",15),n(2,"div",16)(3,"h4"),o(4),i(),n(5,"p",17),o(6),i(),n(7,"p",18),o(8),i()(),n(9,"div",19)(10,"button",20),C("click",function(l){let s=g(e).$implicit;return m(2).generateClientReport(s),p(l.stopPropagation())}),o(11," \u{1F4C4} "),i(),n(12,"button",21),C("click",function(l){let s=g(e).$implicit;return m(2).generateDocumentStatus(s),p(l.stopPropagation())}),o(13," \u{1F4CB} "),i(),n(14,"div",22),o(15),i()()()}if(a&2){let e=t.$implicit,d=m(2);r(),y("src",e.avatarUrl,x)("alt",e.name),r(3),c(e.name),r(2),c(e.status),r(2),c(e.flow),r(6),D(d.getHealthScoreClass(e.healthScore)),r(),w(" ",e.healthScore,"% ")}}function R(a,t){if(a&1&&(n(0,"div",5)(1,"div",7)(2,"div",8)(3,"div",9),o(4,"\u{1F465}"),i(),n(5,"div",10)(6,"h3"),o(7),i(),n(8,"p"),o(9,"Clientes Totales"),i()()(),n(10,"div",8)(11,"div",9),o(12,"\u{1F4BC}"),i(),n(13,"div",10)(14,"h3"),o(15),i(),n(16,"p"),o(17,"Activos"),i()()(),n(18,"div",8)(19,"div",9),o(20,"\u{1F4CA}"),i(),n(21,"div",10)(22,"h3"),o(23),i(),n(24,"p"),o(25,"Oportunidades"),i()()(),n(26,"div",8)(27,"div",9),o(28,"\u2705"),i(),n(29,"div",10)(30,"h3"),o(31),i(),n(32,"p"),o(33,"Completados"),i()()()(),n(34,"div",11)(35,"h2"),o(36,"Actividad Reciente"),i(),n(37,"div",12),O(38,$,16,8,"div",13,F),i()()()),a&2){let e=m();r(7),c(e.clients().length),r(8),c(e.getActiveClients()),r(8),c(e.getOpportunities()),r(8),c(e.getCompletedClients()),r(7),M(e.getRecentClients())}}var T=class a{constructor(t,e){this.simulationService=t;this.pdfService=e}destroy$=new u;clients=h([]);isLoading=h(!0);ngOnInit(){this.loadClients()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadClients(){this.simulationService.getClients().pipe(_(this.destroy$)).subscribe({next:t=>{this.clients.set(t),this.isLoading.set(!1)},error:t=>{console.error("Failed to fetch clients:",t),this.isLoading.set(!1)}})}onClientSelect(t,e){console.log("Client selected:",t,e)}getActiveClients(){return this.clients().filter(t=>["Activo","Pagos al Corriente","Activo en Grupo"].includes(t.status)).length}getOpportunities(){return this.clients().filter(t=>t.status==="Nuevas Oportunidades").length}getCompletedClients(){return this.clients().filter(t=>["Meta Alcanzada","Turno Adjudicado","Completado","Unidad Lista para Entrega"].includes(t.status)).length}getRecentClients(){return this.clients().sort((t,e)=>{let d=t.events[0]?.timestamp||new Date(0),l=e.events[0]?.timestamp||new Date(0);return new Date(l).getTime()-new Date(d).getTime()}).slice(0,5)}getHealthScoreClass(t){return t?t>=90?"health-high":t>=70?"health-medium":"health-low":"health-low"}generateClientReport(t){this.pdfService.generateClientReportPdf(t)}generateDocumentStatus(t){this.pdfService.generateDocumentStatusPdf(t)}static \u0275fac=function(e){return new(e||a)(v(I),v(z))};static \u0275cmp=b({type:a,selectors:[["app-dashboard"]],decls:8,vars:1,consts:[[1,"dashboard-container"],[1,"dashboard-header"],[1,"dashboard-title"],[1,"dashboard-subtitle"],[1,"loading-state"],[1,"dashboard-content"],[1,"spinner"],[1,"metrics-grid"],[1,"metric-card"],[1,"metric-icon"],[1,"metric-info"],[1,"recent-activity"],[1,"activity-list"],[1,"activity-item"],[1,"activity-item",3,"click"],[1,"client-avatar",3,"src","alt"],[1,"activity-content"],[1,"client-status"],[1,"client-flow"],[1,"client-actions"],["title","Generar Reporte PDF",1,"pdf-btn",3,"click"],["title","Estado de Documentos PDF",1,"pdf-btn",3,"click"],[1,"health-score"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Dashboard Principal"),i(),n(4,"p",3),o(5,"Resumen general de la operaci\xF3n"),i()(),E(6,L,4,0,"div",4)(7,R,40,4,"div",5),i()),e&2&&(r(6),P(d.isLoading()?6:7))},dependencies:[k],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:2rem;background-color:#030712;min-height:100vh;color:#e5e7eb}.dashboard-header[_ngcontent-%COMP%]{margin-bottom:2rem}.dashboard-header[_ngcontent-%COMP%]   .dashboard-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#fff;margin:0 0 .5rem}.dashboard-header[_ngcontent-%COMP%]   .dashboard-subtitle[_ngcontent-%COMP%]{color:#9ca3af;margin:0;font-size:1rem}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh;color:#06b6d4}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #374151;border-top:3px solid #06b6d4;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.dashboard-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.metric-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1f2937,#374151);padding:1.5rem;border-radius:12px;border:1px solid #374151;display:flex;align-items:center;gap:1rem;transition:all .3s ease}.metric-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#06b6d4;box-shadow:0 8px 25px #06b6d426}.metric-card[_ngcontent-%COMP%]   .metric-icon[_ngcontent-%COMP%]{font-size:2rem;background:#06b6d41a;padding:.75rem;border-radius:8px}.metric-card[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0 0 .25rem;color:#fff}.metric-card[_ngcontent-%COMP%]   .metric-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#9ca3af;font-size:.875rem;font-weight:500}.recent-activity[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#fff;margin:0 0 1.5rem}.activity-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.activity-item[_ngcontent-%COMP%]{background:#1f2937;padding:1rem;border-radius:8px;border:1px solid #374151;display:flex;align-items:center;gap:1rem;cursor:pointer;transition:all .3s ease}.activity-item[_ngcontent-%COMP%]:hover{background:#374151;border-color:#06b6d4}.activity-item[_ngcontent-%COMP%]   .client-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;object-fit:cover}.activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]{flex:1}.activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#fff;margin:0 0 .25rem}.activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .client-status[_ngcontent-%COMP%]{font-size:.875rem;color:#06b6d4;margin:0 0 .25rem;font-weight:500}.activity-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .client-flow[_ngcontent-%COMP%]{font-size:.75rem;color:#9ca3af;margin:0}.activity-item[_ngcontent-%COMP%]   .health-score[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;padding:.25rem .75rem;border-radius:20px}.activity-item[_ngcontent-%COMP%]   .health-score.health-high[_ngcontent-%COMP%]{background:#10b98133;color:#10b981}.activity-item[_ngcontent-%COMP%]   .health-score.health-medium[_ngcontent-%COMP%]{background:#f59e0b33;color:#f59e0b}.activity-item[_ngcontent-%COMP%]   .health-score.health-low[_ngcontent-%COMP%]{background:#ef444433;color:#ef4444}@media (max-width: 768px){.dashboard-container[_ngcontent-%COMP%]{padding:1rem}.metrics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.activity-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}.activity-item[_ngcontent-%COMP%]   .client-avatar[_ngcontent-%COMP%]{width:40px;height:40px}}"]})};export{T as DashboardComponent};
